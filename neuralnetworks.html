<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>HouzeLiu's Blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/theme/styles.css">
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <link rel="stylesheet" href="/theme/slicknav.css">
    <script src="/theme/jquery.slicknav.min.js"></script>
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
    <script type="text/javascript"
	    src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
    <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.2/html5shiv.js"></script>
    <![endif]-->
<script>
	$(function(){
		$('#menu').slicknav({'label':''});
	});
</script>
<link rel="icon" href="/theme/favicon.ico" sizes="16x16 32x32 48x48 64x64" type="image/vnd.microsoft.icon">
<link rel="apple-touch-icon" sizes="114x114" href="/theme/apple-touch-icon-precomposed.png">
<link rel="apple-touch-icon" sizes="152x152" href="/theme/favicon152.png">
<link rel="apple-touch-icon" sizes="196x196" href="/theme/favicon196.png">
  </head>

  <body>
    <div id="wrapper">

      <header>
	<nav class="byline"><ul id="menu">
        </ul></nav><!-- /#menu -->
        <div class="downloads">
          <a href="https://github.com/houze-liu" class="fa fa-github"></a>
          <a href="" class="fa fa-no"></a>
        </div>
        <hgroup>
          <h1>NeuralNetworks</h1>
  <footer class="article-footer">
    <address class="vcard author">
      By           <a class="url fn" href="/author/houze.html">houze</a>
    </address>
    <abbr class="published" title="2019-08-23T03:48:00+00:00">
       on 23.08.2019
    </abbr>
  </footer><!-- /.post-info -->
        </hgroup>
  



      </header>
<section id="content" class="body article">
  <div class="entry-content">
    <style type="text/css">/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI escape sequences */
/* The color values are a mix of
   http://www.xcolors.net/dl/baskerville-ivorylight and
   http://www.xcolors.net/dl/euphrasia */
.ansi-black-fg {
  color: #3E424D;
}
.ansi-black-bg {
  background-color: #3E424D;
}
.ansi-black-intense-fg {
  color: #282C36;
}
.ansi-black-intense-bg {
  background-color: #282C36;
}
.ansi-red-fg {
  color: #E75C58;
}
.ansi-red-bg {
  background-color: #E75C58;
}
.ansi-red-intense-fg {
  color: #B22B31;
}
.ansi-red-intense-bg {
  background-color: #B22B31;
}
.ansi-green-fg {
  color: #00A250;
}
.ansi-green-bg {
  background-color: #00A250;
}
.ansi-green-intense-fg {
  color: #007427;
}
.ansi-green-intense-bg {
  background-color: #007427;
}
.ansi-yellow-fg {
  color: #DDB62B;
}
.ansi-yellow-bg {
  background-color: #DDB62B;
}
.ansi-yellow-intense-fg {
  color: #B27D12;
}
.ansi-yellow-intense-bg {
  background-color: #B27D12;
}
.ansi-blue-fg {
  color: #208FFB;
}
.ansi-blue-bg {
  background-color: #208FFB;
}
.ansi-blue-intense-fg {
  color: #0065CA;
}
.ansi-blue-intense-bg {
  background-color: #0065CA;
}
.ansi-magenta-fg {
  color: #D160C4;
}
.ansi-magenta-bg {
  background-color: #D160C4;
}
.ansi-magenta-intense-fg {
  color: #A03196;
}
.ansi-magenta-intense-bg {
  background-color: #A03196;
}
.ansi-cyan-fg {
  color: #60C6C8;
}
.ansi-cyan-bg {
  background-color: #60C6C8;
}
.ansi-cyan-intense-fg {
  color: #258F8F;
}
.ansi-cyan-intense-bg {
  background-color: #258F8F;
}
.ansi-white-fg {
  color: #C5C1B4;
}
.ansi-white-bg {
  background-color: #C5C1B4;
}
.ansi-white-intense-fg {
  color: #A1A6B2;
}
.ansi-white-intense-bg {
  background-color: #A1A6B2;
}
.ansi-default-inverse-fg {
  color: #FFFFFF;
}
.ansi-default-inverse-bg {
  background-color: #000000;
}
.ansi-bold {
  font-weight: bold;
}
.ansi-underline {
  text-decoration: underline;
}
/* The following styles are deprecated an will be removed in a future version */
.ansibold {
  font-weight: bold;
}
.ansi-inverse {
  outline: 0.5px dotted;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  position: relative;
  overflow: visible;
}
div.cell:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: transparent;
}
div.cell.jupyter-soft-selected {
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected,
div.cell.selected.jupyter-soft-selected {
  border-color: #ababab;
}
div.cell.selected:before,
div.cell.selected.jupyter-soft-selected:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: #42A5F5;
}
@media print {
  div.cell.selected,
  div.cell.selected.jupyter-soft-selected {
    border-color: transparent;
  }
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
}
.edit_mode div.cell.selected:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: #66BB6A;
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  /* Note that this should set vertical padding only, since CodeMirror assumes
       that horizontal padding will be set on CodeMirror pre */
  padding: 0.4em 0;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only,
    use .CodeMirror-lines for vertical */
  padding: 0 0.4em;
  border: 0;
  border-radius: 0;
}
.CodeMirror-cursor {
  border-left: 1.4px solid black;
}
@media screen and (min-width: 2138px) and (max-width: 4319px) {
  .CodeMirror-cursor {
    border-left: 2px solid black;
  }
}
@media screen and (min-width: 4320px) {
  .CodeMirror-cursor {
    border-left: 4px solid black;
  }
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
div.output_area .mglyph > img {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 1px 0 1px 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}
.rendered_html ul:not(.list-inline),
.rendered_html ol:not(.list-inline) {
  padding-left: 2em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}





.rendered_html pre,




.rendered_html tr,
.rendered_html th,


.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,


.rendered_html * + .alert {
  margin-top: 1em;
}
[dir="rtl"] 
div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.rendered .rendered_html tr,
.text_cell.rendered .rendered_html th,
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.text_cell .dropzone .input_area {
  border: 2px dashed #bababa;
  margin: -1px;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
</style>
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
<style type="text/css">
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
</style><body>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Training-A-Neural-Network">Training A Neural Network<a class="anchor-link" href="#Training-A-Neural-Network">&#182;</a></h1><p>Neural network(NN) has many applications. It has large amount of parameters we can train. Usually we train a NN to minimize loss function and make it perform well on some tasks.
In this notebook, we are going to walk through a simple NN that can classify data into binary classes.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># import libraries</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="preliminary">preliminary<a class="anchor-link" href="#preliminary">&#182;</a></h2><p>A neural network usually has many hidden layers and weights matrix as connection. Each unit must pass through activation function to decide fire or not.
$$
H_2 = \sigma (H_1 * W_1)
$$
$H_1$ and $H_2$ are hidden layers and $W_1$ is weight matrix and $\sigma$ is activation function. $\sigma$ is applied  element-wisely.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are many choices for activation functions, i.e., <a href="https://en.wikipedia.org/wiki/Sigmoid_function">Sigmoid</a>: $\sigma(x) = \frac{1}{1+e^{-x}} $<br>
The higher output, the higher probability of being 'activated'.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">sigmoid</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mf">1.</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">))</span>


<span class="c1"># a plot sigmoid function</span>
<span class="n">line</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">line</span><span class="p">),</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;input&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;output&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;sigmoid&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Steepest gradient descent:</strong><br>
Usually we go a little step to update weight matrix using gradient: $W_1 = W_1 - \alpha \cdot \frac{d L}{d W_1}$. This update rule is justified by <a href="http://mathworld.wolfram.com/MethodofSteepestDescent.html">steepest gradient descent</a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>$W_1$ update using derivative $\frac{d L}{d W_1}$(or gradient)</strong>:<br>
Firstly, we specify our notations:<br>
$H_1^{(i)(j)}$: $i$ th row $j$ th colume in $H_1$, $I$ rows X $J$ columes in total;<br>
$W_1^{(j)(k)}$: $j$ th row $k$ th colume in $W_1$, $J$ rows X $K$ columes in total;<br>
$H_2^{(i)(k)}$: $i$ th row $k$ th colume in $H_2$, $I$ rows X $K$ columes in total;<br>
Let's start by partial derivative of certain element of $W_1$, say $\frac{\partial L}{\partial W_1^{(j)(k)}}$. According to chain rule:<br>
$$
\frac{\partial L}{\partial W_1^{(j)(k)}} = \frac{\partial  H_2}{\partial W_1^{(j)(k)}} \cdot \frac{\partial L}{\partial H_2} 
$$<br>
So if $W_1^{(j)(k)}$ is changed, $H_2$ will also change; As $H_2$ has changed, so does $L$. We want to sum up all such changes in $L$, our objective is to minimize it:<br>
$$
\frac{\partial L}{\partial W_1^{(j)(k)}} =
\sum_{i=1}^{I} \frac{\partial H_2^{(i)(k)}}{\partial W_1^{(j)(k)}} \frac{\partial L}{\partial H2^{(i)(k)}} \dots \dots (1)
$$
Notice that those are coefficeints of linear function:<br>
$$
\sum_{j=1}^{J} H_1^{(i)(j)} W_1^{(j)(k)} = H_2^{(i)(k)}
$$
Hence, $\frac{\partial H_2^{(i)(k)}}{\partial W_1^{(j)(k)}} = H_1^{(i)(j)}$. Plug it into equation $(1)$ above:<br>
$$
\frac{\partial L}{\partial W_1^{(j)(k)}} = \sum_{i=1}^{I} H_1^{(i)(j)} \frac{\partial L}{\partial H2^{(i)(k)}}
$$
Here is an illustration:<br>
<img src="./assets/pic.png" alt="pic" width="600"/></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the image above, $j$ and $k$ is fixed for partial derivative of $W_1^{(j)(k)}$; $\sum$ is over $i$, which can be seen as dot-product between $j$th in $H_1$ and $k$th colume in $\frac{\partial L}{\partial H_2}$.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So far we get $\frac{\partial L}{\partial W_1^{(j)(k)}}$, which is one element in $\frac{\partial L}{\partial W_1}$, but we need the all elements. The interesting thing is that , if we do the same operation to every element using one colume in $H_1$ and one colume in $\frac{\partial L}{\partial H_2}$ and do dot-product, the result is just matrix multiplication between $H_1$ reversed and $\frac{\partial L}{\partial H_2}$: 
$$
\frac{\partial L}{\partial W_1} = H_1^T * \frac{\partial L}{\partial H_2}
$$
Where $*$ is matrix multiplication.<br>
Here is an illustration:<br>
<img src="./mul.png" alt="mul" width="600"/></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can shift $j$ and $k$ to get any $\frac{\partial L}{\partial W_1^{(j)(k)}}$ of $\frac{\partial L}{\partial W_1}$.<br>
Recall that we want to update our weight matrix $W_1$ using <strong>steepest gradient descent</strong>: $W_1 = W_1 - \alpha \cdot \frac{d L}{d W_1}$; Now we only need to choose a proper $\alpha$ and train our network!(not really, actually)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Training-and-Visualization">Training and Visualization<a class="anchor-link" href="#Training-and-Visualization">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Step 1:</strong> preparing training data.<br>
We are going to train our neural net to do binary classification. So our data consists of 10000 samples from gaussian distribution $g_0\sim N(-6,1)$, and another 10000 samples from $g_1\sim N(6,1)$. We expect our neural net to output probability close to 1 when given new samples from $g_1$ and close to 0 when given samples from $g_0$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># guassian1</span>
<span class="n">g0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span> <span class="o">-</span> <span class="mi">6</span>
<span class="n">g0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">g0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1"># guassian2</span>
<span class="n">g1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span> <span class="o">+</span> <span class="mi">6</span>
<span class="n">g1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">g1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">g0</span><span class="p">,</span> <span class="n">g1</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">g0</span><span class="p">),</span>\
               <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">g1</span><span class="p">)])</span>
<span class="c1"># pack data and corresponding label</span>
<span class="n">data_and_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)))</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">data_and_label</span><span class="p">)</span>

<span class="n">X_train</span> <span class="o">=</span> <span class="n">data_and_label</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">data_and_label</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># true labels</span>

<span class="c1"># take a look at firs 5th elements</span>
<span class="c1"># in X_train and y_train</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_train</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_train</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[[ 5.06516143]
 [-5.83762382]
 [-5.34864671]
 [ 6.01076143]
 [ 3.96512735]]
[[1.]
 [0.]
 [0.]
 [1.]
 [1.]]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Step 2:</strong> train our neural net!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># define cross-entropy loss function</span>
<span class="k">def</span> <span class="nf">binary_logistic_loss</span><span class="p">(</span><span class="n">prediction</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">prediction</span>
    <span class="n">y_hat</span> <span class="o">=</span> <span class="n">label</span>
    <span class="n">epsilon</span> <span class="o">=</span> <span class="mf">1e-4</span>
    <span class="n">error</span> <span class="o">=</span> <span class="o">-</span> <span class="n">y</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">y_hat</span> <span class="o">+</span> <span class="n">epsilon</span><span class="p">)</span> <span class="o">-</span>\
        <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">y_hat</span> <span class="o">+</span> <span class="n">epsilon</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">error</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># initialization</span>
<span class="n">Wxh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="n">bxh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
<span class="n">Whh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">bhh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># set step size</span>
<span class="n">step</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># train</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="c1"># forward:</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Wxh</span><span class="p">)</span> <span class="o">+</span> <span class="n">bxh</span>
    <span class="n">h_sigmoid</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
    <span class="c1"># hh means h-&gt;out</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">h_sigmoid</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Whh</span><span class="p">)</span> <span class="o">+</span> <span class="n">bhh</span>
    <span class="n">y_hat</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">binary_logistic_loss</span><span class="p">(</span><span class="n">y_hat</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">L</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="o">/</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># backforward:</span>
    <span class="n">derror</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># backprop through cross-entropy loss</span>
    <span class="n">dy_hat2error</span> <span class="o">=</span> <span class="n">y_train</span> <span class="o">*</span> <span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="o">-</span><span class="n">y_hat</span><span class="p">)</span> <span class="o">+</span> \
                  <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">y_train</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">y_hat</span><span class="p">))</span>
    <span class="c1"># backpro through sigmoid</span>
    <span class="n">dout2y_hat</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">y_hat</span><span class="p">)</span> <span class="o">*</span> <span class="n">y_hat</span>
    <span class="c1"># chain rule</span>
    <span class="n">dout</span> <span class="o">=</span> <span class="n">dout2y_hat</span> <span class="o">*</span> <span class="n">dy_hat2error</span> <span class="o">*</span> <span class="n">derror</span>
    <span class="c1"># dW_1 = H_1.T * H_2</span>
    <span class="n">dWhh</span> <span class="o">=</span> <span class="n">h_sigmoid</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">dout</span><span class="p">)</span>
    <span class="n">dhh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dout</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">dh_sigmoid</span> <span class="o">=</span> <span class="n">dout</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Whh</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="n">dh2h_sigmoid</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">h_sigmoid</span><span class="p">)</span> <span class="o">*</span> <span class="n">h_sigmoid</span>
    <span class="n">dh</span> <span class="o">=</span> <span class="n">dh2h_sigmoid</span> <span class="o">*</span> <span class="n">dh_sigmoid</span>
    <span class="n">dWxh</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">dh</span><span class="p">)</span>
    <span class="n">dbxh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dh</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="c1"># update</span>
    <span class="n">Whh</span> <span class="o">-=</span> <span class="n">step</span> <span class="o">*</span> <span class="n">dWhh</span>
    <span class="n">bhh</span> <span class="o">-=</span> <span class="n">step</span> <span class="o">*</span> <span class="n">dhh</span>
    <span class="n">Wxh</span> <span class="o">-=</span> <span class="n">step</span> <span class="o">*</span> <span class="n">dWxh</span>
    <span class="n">bxh</span> <span class="o">-=</span> <span class="n">step</span> <span class="o">*</span> <span class="n">dbxh</span>

    <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;epoch: </span><span class="si">{}</span><span class="s2">; loss: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">L</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch: 0; loss: 7.026175126442632
epoch: 100; loss: 0.010359224724804477
epoch: 200; loss: 0.005612259087126668
epoch: 300; loss: 0.003831209976110012
epoch: 400; loss: 0.0028971872797366183
epoch: 500; loss: 0.0023218305238442496
epoch: 600; loss: 0.0019317631092453376
epoch: 700; loss: 0.001649870281502195
epoch: 800; loss: 0.0014366244938535712
epoch: 900; loss: 0.0012696687144646771
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Step 3:</strong> plot result</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># X_predict is 10000 real numbers from [-10, 10]</span>
<span class="n">line</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
<span class="n">X_predict</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1"># make prediction</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">X_predict</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Wxh</span><span class="p">)</span> <span class="o">+</span> <span class="n">bxh</span>
<span class="n">h_sigmoid</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="c1"># hh means h-&gt;out</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">h_sigmoid</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Whh</span><span class="p">)</span> <span class="o">+</span> <span class="n">bhh</span>
<span class="n">y_hat</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">g0</span><span class="p">,</span> <span class="n">hist</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
             <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkblue&#39;</span><span class="p">,</span>
             <span class="n">kde_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;linewidth&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">g1</span><span class="p">,</span> <span class="n">hist</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
             <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span>
             <span class="n">kde_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;linewidth&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">g0</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">g0</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span>\
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;darkblue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">g1</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span>\
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">y_hat</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;Decision Boundary&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;density&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Histogram&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="o">.</span><span class="mi">025</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\mu,\ \sigma$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>/Users/ellise/anaconda2/envs/py36/lib/python3.6/site-packages/scipy/stats/stats.py:1713: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  return np.add.reduce(sorted[indexer] * weights, axis=axis) / sumval
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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OadTp04pLy9PAwYMCDoOAAAAAMS8uKADADGrulp66CFp2DDpkUc8uWRFRYW6du16wdINrZuZqWvXrhdd8QgAAAAACB9WvAFBefVVafdu6bXXpDZtPLsspVts4+8fAAAAACIHK96AoDz1lHT11dIXvhB0Ek/Fx8dr7NixuvrqqzVmzBg99dRTqqmpuaJrPfbYY3r//fcv+PkvfvELvfzyy1catd7BgweVkpKisWPHasyYMZo6dap27drV4uteSvv27X2/BwAAAAAgOKx4A4KwZYu0caP0k59Ica2r/05JSdHmzZslSSdOnNDtt9+uoqIiPfHEE5d9re9///sX/fy+++67ooxNGTRoUH3uX/7yl/rRj36k3/zmN55dv6Wcc3LOKa6V/e8FAAAAAFoz/h8cEISXXpKSkqTbbw86ia/S0tL0/PPP69lnn5VzTtXV1fqXf/kXTZgwQaNHj9Yvf/nL+nOffPJJjRo1SmPGjNHDDz8sSbrrrrv02muvSZIefvhhjRgxQqNHj9a3vvUtSdLjjz+u//qv/5Ikbd68WZMnT9bo0aP1hS98QWfOnJEkZWVl6V//9V81ceJEDR06VCtXrrxk7rNnz6pz586SQvvm3X333Ro1apQyMzO1YsUKSdJLL72kBx54oP47N998s7KzsyWFVrI98sgjGjNmjCZPnqzjx49Lkg4cOKApU6ZowoQJevTRR+u/W1JSojlz5mjcuHEaNWqU3nrrLUmhlXjDhw/XN77xDY0bN04/+MEP9OCDD9Z/74UXXtBDDz3U3L8OAAAAAECYseINCDfnpDfflG68Uera1b/7/PM/S7UruBpKqa6W4uOv7Jpjx0pPP31ZXxk4cKBqamp04sQJvfXWW+rYsaPWrVunc+fOadq0abrhhhu0c+dOvfnmm1q7dq3atm2r06dPf+oap0+f1htvvKGdO3fKzFRYWPiZ+9x555366U9/qpkzZ+qxxx7TE088oadrs1ZVVSknJ0eLFi3SE0880eT46r59+zR27FgVFxerrKxMa9eulSQ999xzkqStW7dq586duuGGG7R79+6L/plLS0s1efJk/fCHP9S3v/1tvfDCC/re976nf/qnf9L999+vO++8s/66kpScnKw33nhDHTp00MmTJzV58mTNnz9fkrRr1y69+OKL+tnPfqbS0lKNHj1aTz75pBITE/Xiiy9+qrwE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ttzdL3P3NYkZS9cSf/xw4oEZTc1sPvDzxOiZe4A5ZvavwKfECxCp8J13P5nZicDv3X0kcALwp8Tf5pnAi+7+ZoqyHfBvZnYm8UfKNgLj6+ZMzCQ6ifgf4SHgWXdfk+KcvwHCxB89BPgoMUtooP3ZUN+Y2aPAx+4+j/j99ryZFRIf6TYmmZkacC5wA7DKzJYn1t0PnATg7r8jXhT8hZnVABXAmFQXCGngGprZrbVyzic+o2khUA7cmOKMAJhZa+Kz2Y6vta52zkD608xmEx+51tHMioCHgF8DL5nZTcBmYHSi7WDgVnf/ubvvNrMpxIvJAI+6e8pHZoqIiIiIiBzLLPV/Z4uIiIiIiIiIiBz7mtujpiIiIiIiIiIiIs2CCm8iIiIiIiIiIiJJoMKbiIiIiIiIiIhIEqjwJiIiIiIiIiIikgQqvImIiIiIiIiIiCSBCm8iIiIiIiIiIiJJoMKbiIiIiIiIiIhIEqjwJvI9mdkQM1tpZjlm1sbM1pjZ6UHnEhEREREREZFgmbsHnUGk2TOzfwVygFZAkbtPDTiSiIiIiIiIiARMhTeRJmBm2cBSoBI4x92jAUcSERERERERkYDpUVORplEA5AJtiY98ExEREREREZEWTiPeRJqAmc0D5gA9gc7uPingSCIiIiIiIiISsMygA4g0d2b2U6DG3V80sxCw2Mwudvd3g84mIiIiIiIiIsHRiDcREREREREREZEk0DveREREREREREREkkCFNxERERERERERkSRQ4U1ERERERERERCQJVHgTERERERERERFJAhXeREREREREREREkkCFNxERERERERERkSRQ4U1ERERERERERCQJVHgTERERERERERFJgv8PgIG3ZHkZof8AAAAASUVORK5CYII=
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>From the picture above, we can see that if given samples greater than 2.5, our NN will predict close to 1; if given samples less than -2.5, it will predict close to 0. Hence, if our NN predict larger than 0.5, we can label input sample as coming from $g_1$; if less than 0.5, from $g_1$. In this way, we can give NN new samples as input and do classification.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Supplementary">Supplementary<a class="anchor-link" href="#Supplementary">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Derivative of Sigmoid function:</strong> 
$$
\begin{align}
\sigma(x) = \frac{1}{1+e^{-x}};  \\
\frac{d \sigma(x)}{d x} = \frac{-1}{(1+e^{-x})^2}\cdot(-e^{-x}) \\
                        = \frac{e^{-x}}{(1+e^{-x})^2} \\
                        = \frac{1}{(1+e^{-x}} \cdot (1-\frac{1}{1+e^{-x}}) \\
                        = \sigma(x) \cdot (1-\sigma(x)) 
\end{align}
$$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Cross Entropy:</strong> cross-entropy between two distribution $p$ and $q$ is defined as $H[p,q] = -\sum_i p(x_i)\log q(x_i)$. We can expand it as follow:<br>
$$
\begin{align}
H[p,q] = -\sum_i p(x_i)\log q(x_i)\\
       = \sum_i p(x_i)\log[ \frac{p(x_i)}{q(x_i)} \cdot \frac{1}{p(x_i)}] \\
       = - \sum_i p(x_i)\log p(x_i) + \sum_i p(x_i)\log\frac{p(x_i}{q(x_i)} \\
       = H[p] + D_{KL}(p||q)
\end{align}
$$<br>
For classification task where we have correct labels, our label distribution is $p(x)$; we want our prediction distribution $q(x)$ as close to $p(x)$ as possible. Minimizing $H[p,q]$ can be seen as reducing KL-divergence between label distribution and prediction distribution: if two distributions are equal, then $D_{KL}(p||q)=0$ and $H[p,q] = H[p]$ exactly. We can not change $H[p]$.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For binary classification, our $x$ can only take two values: 0, 1 
$$
H[p,q] = - p(x=0)\log q(x=0) - p(x=1)\log q(x=1)
$$
The loss function for such idea is: 
$$
L = -y\log \hat y - (1-y) \log (1-\hat y)
$$
Where $y$ is true label and $\hat y$ is prediction. $y$ can only be 0 or 1. If 1, the second term is 0 regardless of $\hat y$, only first term remains; if 0, the first term is always 0, only second term remains.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Derivative of Cross Entropy Function:</strong> take derivative w.r.t $\hat y$, should be straight forward.</p>

</div>
</div>
</div>
 

</body>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>

  </div><!-- /.entry-content -->
  <div class="article-share-tags">
  <div class="end-article-tags">
  </div>
  <div class='article-share'>
      share -
  </div>
  </div>
</section>
<div class="neighbors">
</div>
      <footer>
	  <a href="/" >Home</a>
	  <div class="right-footer">
    <a href="/pages/about.html" >About Me</a>

	  <!-- <a href="/categories.html" >Categories</a>
	  <a href="/tags.html" >Tags</a> -->
	  </div>
      </footer>
</body>
</html>